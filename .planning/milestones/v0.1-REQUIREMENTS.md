# Requirements Archive: v0.1 Formal Verification POC

**Archived:** 2026-02-12
**Status:** SHIPPED

---

# Requirements: rust-fv

**Defined:** 2026-02-10
**Core Value:** Sound, automated verification of Rust code properties with minimal developer burden

## v1 Requirements (All Shipped in v0.1)

### Soundness (SND)

- [x] **SND-01**: VCGen uses path-condition-based encoding for sound control-flow handling -- v0.1 (Phase 1)
- [x] **SND-02**: Multi-path control flow (if/else, match, early return) produces sound verification results -- v0.1 (Phase 1)
- [x] **SND-03**: All arithmetic encoding verified against Rust overflow semantics (checked, wrapping, saturating) -- v0.1 (Phase 1)
- [x] **SND-04**: Soundness test suite: 22 programs with known bugs are rejected by the verifier -- v0.1 (Phase 1)
- [x] **SND-05**: Completeness test suite: 22 correct programs verify successfully -- v0.1 (Phase 1)
- [x] **SND-06**: Nightly rustc version pinned in rust-toolchain.toml with compatibility documentation -- v0.1 (Phase 1)

### Verification Features (VER)

- [x] **VER-01**: Loop invariants via `#[invariant(expr)]` attribute with 3 VCs (init, preservation, exit) -- v0.1 (Phase 2)
- [x] **VER-02**: `assert!(expr)` statements verified statically from MIR -- v0.1 (Phase 2)
- [x] **VER-03**: Panic detection for `unwrap()`, `expect()`, and array indexing -- v0.1 (Phase 2)
- [x] **VER-04**: Division-by-zero verification for all integer division/remainder operations -- v0.1 (Phase 2)
- [x] **VER-05**: Shift overflow verification for shift operations exceeding bit width -- v0.1 (Phase 2)

### Type Encoding (TYP)

- [x] **TYP-01**: Structs encoded as SMT datatypes with constructors and field selectors -- v0.1 (Phase 2)
- [x] **TYP-02**: Tuples encoded as SMT datatypes with positional selectors -- v0.1 (Phase 2)
- [x] **TYP-03**: Enum variants encoded as SMT datatypes with discriminant and variant data -- v0.1 (Phase 2)
- [x] **TYP-04**: Array/slice types encoded using SMT array theory -- v0.1 (Phase 2)

### Specification Language (SPEC)

- [x] **SPEC-01**: Specification parser supports full Rust expression syntax via syn -- v0.1 (Phase 2)
- [x] **SPEC-02**: Quantifiers (`forall`, `exists`) supported in specifications -- v0.1 (Phase 4)
- [x] **SPEC-03**: Ghost code via `#[ghost]` attribute, erased at compile time -- v0.1 (Phase 4)
- [x] **SPEC-04**: Unbounded mathematical integers (`int`, `nat`) for specification-only types -- v0.1 (Phase 4)
- [x] **SPEC-05**: `old(expr)` operator for referring to pre-state values in postconditions -- v0.1 (Phase 2)

### Modular Verification (MOD)

- [x] **MOD-01**: Inter-procedural verification using function contracts as summaries -- v0.1 (Phase 3)
- [x] **MOD-02**: Call sites encoded as: assert precondition, havoc return, assume postcondition -- v0.1 (Phase 3)
- [x] **MOD-03**: Function signature-to-contract map built from HIR -- v0.1 (Phase 3)
- [x] **MOD-04**: Basic ownership reasoning leveraging Rust's borrow checker guarantees -- v0.1 (Phase 3)

### Borrow Reasoning (BRW)

- [x] **BRW-01**: Mutable borrow reasoning via prophecy variables (Creusot-style) -- v0.1 (Phase 4)
- [x] **BRW-02**: Prophecy lifecycle: creation at borrow, resolution at borrow expiration -- v0.1 (Phase 4)
- [x] **BRW-03**: Trait/generic support via monomorphization-based verification -- v0.1 (Phase 4)

### Tooling (TOOL)

- [x] **TOOL-01**: `cargo verify` command as cargo subcommand -- v0.1 (Phase 2)
- [x] **TOOL-02**: Cargo-style output with colored status per function (OK/FAIL/TIMEOUT) -- v0.1 (Phase 2)
- [x] **TOOL-03**: z3 crate with `bundled` feature as native solver backend -- v0.1 (Phase 2)
- [x] **TOOL-04**: Structured tracing via `tracing` crate for debugging verification pipeline -- v0.1 (Phase 2)
- [x] **TOOL-05**: Error messages show source location, failed property, and counterexample -- v0.1 (Phase 5)

### Performance (PERF)

- [x] **PERF-01**: Sub-1s verification for single-function contracts -- v0.1 (Phase 1)
- [x] **PERF-02**: Sub-5s verification for functions with loops and inter-procedural calls -- v0.1 (Phase 5)
- [x] **PERF-03**: VC caching for unchanged functions (skip re-verification) -- v0.1 (Phase 5)
- [x] **PERF-04**: Parallel verification of independent VCs across solver instances -- v0.1 (Phase 5)
- [x] **PERF-05**: Formula simplification (constant folding, dead code elimination, CSE) -- v0.1 (Phase 5)

## v2 Requirements (Deferred)

### Advanced Verification

- **ADV-01**: Trigger customization (`#[trigger]`) for SMT quantifier performance tuning
- **ADV-02**: Standard library contracts for Vec, HashMap, Option, Result
- **ADV-03**: Concurrency verification (atomics, locks, async/await)
- **ADV-04**: Unsafe code verification with conservative approximations
- **ADV-05**: AI-assisted proof generation (LLM-based invariant inference)
- **ADV-06**: Recursive function support with termination measures (`#[decreases]`)

### IDE Integration

- **IDE-01**: VSCode extension for real-time verification feedback
- **IDE-02**: rust-analyzer integration for inline diagnostics
- **IDE-03**: LSP-compatible verification status reporting

## Out of Scope

| Feature | Reason |
|---------|--------|
| Forked Rust compiler | Maintenance nightmare; zero-friction cargo workflow is key differentiator |
| Fully automatic verification (no annotations) | Undecidable for general programs; be honest about 80-90% automation |
| Full dependent types | Academic complexity; stick to refinement types |
| Custom SMT solver | Use Z3/CVC5 ecosystem; proven, maintained |
| Formal proof certificates | Too heavy for developer workflow |
| Windows support | Focus on macOS/Linux first; defer to community demand |
| One-size-fits-all proof automation | Different code needs different strategies; tunable automation |

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| SND-01 | Phase 1 | Shipped v0.1 |
| SND-02 | Phase 1 | Shipped v0.1 |
| SND-03 | Phase 1 | Shipped v0.1 |
| SND-04 | Phase 1 | Shipped v0.1 |
| SND-05 | Phase 1 | Shipped v0.1 |
| SND-06 | Phase 1 | Shipped v0.1 |
| VER-01 | Phase 2 | Shipped v0.1 |
| VER-02 | Phase 2 | Shipped v0.1 |
| VER-03 | Phase 2 | Shipped v0.1 |
| VER-04 | Phase 2 | Shipped v0.1 |
| VER-05 | Phase 2 | Shipped v0.1 |
| TYP-01 | Phase 2 | Shipped v0.1 |
| TYP-02 | Phase 2 | Shipped v0.1 |
| TYP-03 | Phase 2 | Shipped v0.1 |
| TYP-04 | Phase 2 | Shipped v0.1 |
| SPEC-01 | Phase 2 | Shipped v0.1 |
| SPEC-02 | Phase 4 | Shipped v0.1 |
| SPEC-03 | Phase 4 | Shipped v0.1 |
| SPEC-04 | Phase 4 | Shipped v0.1 |
| SPEC-05 | Phase 2 | Shipped v0.1 |
| MOD-01 | Phase 3 | Shipped v0.1 |
| MOD-02 | Phase 3 | Shipped v0.1 |
| MOD-03 | Phase 3 | Shipped v0.1 |
| MOD-04 | Phase 3 | Shipped v0.1 |
| BRW-01 | Phase 4 | Shipped v0.1 |
| BRW-02 | Phase 4 | Shipped v0.1 |
| BRW-03 | Phase 4 | Shipped v0.1 |
| TOOL-01 | Phase 2 | Shipped v0.1 |
| TOOL-02 | Phase 2 | Shipped v0.1 |
| TOOL-03 | Phase 2 | Shipped v0.1 |
| TOOL-04 | Phase 2 | Shipped v0.1 |
| TOOL-05 | Phase 5 | Shipped v0.1 |
| PERF-01 | Phase 1 | Shipped v0.1 |
| PERF-02 | Phase 5 | Shipped v0.1 |
| PERF-03 | Phase 5 | Shipped v0.1 |
| PERF-04 | Phase 5 | Shipped v0.1 |
| PERF-05 | Phase 5 | Shipped v0.1 |

**Coverage:**
- v1 requirements: 37 total
- Shipped: 37
- Remaining: 0

---
*Requirements defined: 2026-02-10*
*Archived: 2026-02-12 after v0.1 milestone completion*
